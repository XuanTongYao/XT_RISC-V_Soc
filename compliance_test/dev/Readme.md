# ä¸€è‡´æ€§æµ‹è¯•

æœ¬æ–‡æ¡£**æœªå®Œæˆ**ï¼

åœ¨å¯¹å¤„ç†å™¨è¿›è¡Œå…·ä½“çš„å®Œæ•´éªŒè¯å‰ï¼Œå¯ä»¥å…ˆå¿«é€Ÿè¿è¡Œä¸€è‡´æ€§æµ‹è¯•ã€‚

ä¸€è‡´æ€§æµ‹è¯•ç”¨äºç¡®è®¤å¤„ç†å™¨åŸºæœ¬ç»“æ„ã€åŸºæœ¬è¡Œä¸ºåœ¨å…è®¸çš„[ISAè§„èŒƒ](https://riscv.org/specifications/ratified/)å†…ï¼Œä¸ç­‰åŒäºå®Œæ•´éªŒè¯æµ‹è¯•ã€‚

é€šè¿‡æµ‹è¯•åªèƒ½è¯´æ˜å¤„ç†å™¨åŸºæœ¬ç¬¦åˆRISC-Vè§„èŒƒï¼Œèƒ½æ­£ç¡®æ‰§è¡Œè½¯ä»¶ã€‚

å®˜æ–¹[æµ‹è¯•ä»“åº“](https://github.com/riscv-non-isa/riscv-arch-test)åœ¨æ­¤

## ç¯å¢ƒæ­å»º

å¯ä»¥å‚è€ƒ[å®˜æ–¹æ–‡æ¡£]çš„**Getting Started**ç« èŠ‚ï¼Œä¸‹é¢åªæ˜¯è®°å½•å®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€äº›**å‘**å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚

### ç³»ç»Ÿç¯å¢ƒ

é¦–å…ˆå‡†å¤‡å¥½ä¸€ä¸ªUbuntuè™šæ‹Ÿæœºæˆ–è€…[WSL](https://learn.microsoft.com/zh-cn/windows/wsl/install)ï¼Œè¿™ä¸å±äºæµ‹è¯•å†…å®¹ã€‚

### å®‰è£… Python

åœ¨æœ€æ–°çš„Ubuntuä¸Šå¾ˆæœ‰å¯èƒ½å·²ç»é¢„è£…äº†Python 3.12ï¼Œå¦åˆ™å…ˆå®‰è£…Python:

```shell
sudo apt update
# è‡ªè¡Œè°ƒæ•´è¦å®‰è£…çš„Pythonç‰ˆæœ¬
sudo apt-get install python3.12
sudo apt install python3-pip
sudo apt install python3.12-venv
```

å®‰è£…å®Œæˆåè¯·å…ˆç¡®è®¤å®‰è£…æˆåŠŸ

```shell
python3 --version
pip3 --version
```

æ–°ç³»ç»Ÿé»˜è®¤å¯¹PythonåŒ…è¿›è¡Œäº†é™åˆ¶ï¼Œä¸å…è®¸åœ¨ç³»ç»Ÿç¯å¢ƒä¸­å®‰è£…æˆ–å‡çº§ Python åŒ…ï¼Œä»¥é¿å…ç ´åç³»ç»Ÿè‡ªå¸¦çš„ Python é…ç½®ã€‚

éœ€è¦åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼ˆè‡ªè¡Œå†³å®šåˆ›å»ºç›®å½•ï¼‰`python3 -m venv [myenv_path]`

ç„¶åå¯ä»¥ä½¿ç”¨è¿™æ¡æŒ‡ä»¤è¿›å…¥åˆ°è™šæ‹Ÿç¯å¢ƒ`source [myenv_path]/bin/activate`ï¼Œç»ˆç«¯å‰é¢å¤šäº†ä¸ªæ‹¬å·è¡¨æ˜è¿›å…¥äº†è™šæ‹Ÿç¯å¢ƒï¼Œä¾‹å¦‚ï¼š`(myenv) user@host:~$`

æœ€åæ›´æ–°pip`pip3 install --upgrade pip`

ä¹‹åçš„æ‰€æœ‰æ“ä½œéƒ½åœ¨**è™šæ‹Ÿç¯å¢ƒ**ä¸­è¿›è¡Œï¼ï¼ï¼

### å®‰è£… riscv-ctg å’Œ riscv-isac

å‚ç…§[å®˜æ–¹æ–‡æ¡£]å³å¯

### å®‰è£… RISCOF

å‚ç…§[å®˜æ–¹æ–‡æ¡£]å³å¯

### å®‰è£… RISCV-GNU å·¥å…·é“¾

å®˜æ–¹æ–‡æ¡£ä¸­ä¼šå…‹éš†ä»“åº“å¹¶åœ¨æœ¬åœ°æ„å»ºï¼Œè¿™å°†ä¼šæ¶ˆè€—å¤§é‡çš„æµé‡ä¸æ—¶é—´ï¼Œå¯ä»¥è‡ªè¡Œå¯»æ‰¾é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶ç‰ˆæœ¬è¿›è¡Œå®‰è£…ä»¥èŠ‚çº¦æ—¶é—´ï¼Œå¦‚æœä¸å…³å¿ƒï¼Œå‚ç…§[å®˜æ–¹æ–‡æ¡£]å³å¯

å¯ä»¥æŠŠå‘½ä»¤ä¸­çš„`/path/to/install`æ›¿æ¢ä¸ºå…¶ä»–å®‰è£…ä½ç½®`[riscv-gnu-install-path]`ï¼Œå®‰è£…å®Œæˆå**åŠ¡å¿…**ç¼–è¾‘è™šæ‹Ÿç¯å¢ƒä¸­çš„å¯åŠ¨è„šæœ¬ï¼š`nano [myenv_path]/bin/activate`ï¼Œåœ¨æœ€ååŠ ä¸€è¡Œ`export PATH="[riscv-gnu-install-path]/bin:$PATH"`ä»è€ŒæŠŠå·¥å…·é“¾æ·»åŠ åˆ°`$PATH`ä¸­

é‡æ–°è¿›å…¥è™šæ‹Ÿç¯å¢ƒåå¯ä»¥éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ`riscv32-unknown-elf-cpp --version`

**æ³¨æ„**ï¼šä½ å®Œå…¨å¯ä»¥ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨ï¼Œä¸ä¸€å®šæ˜¯`nano`

### å®‰è£… RISC-V å‚è€ƒæ¨¡å‹ï¼šSpike å’Œ SAIL

å‚ç…§[å®˜æ–¹æ–‡æ¡£]å³å¯

å‘½ä»¤ä¸­çš„`[sudo]`è¡¨ç¤ºå¯é€‰é¡¹ï¼Œæ³¨æ„è¾¨åˆ«ï¼Œä¸è¦åŸå°ä¸åŠ¨å¤åˆ¶å‘½ä»¤

æ„å»º RISC-V Sailæ—¶å¯èƒ½éœ€è¦å®‰è£…cmake`sudo apt install cmake`

### å¿…è¦çš„ç¯å¢ƒæ–‡ä»¶

- **config.ini**:åœ¨å…‹éš†**riscv-arch-test**ä»“åº“æ—¶å·²ç»å®‰è£…ï¼Œä½äº`riscv-arch-test/riscof-plugins/rv32[64]/`
- **riscv-test-suite/**: åœ¨å…‹éš†**riscv-arch-test**ä»“åº“æ—¶å·²ç»å®‰è£…ï¼Œä½äº`riscv-arch-test/riscv-test-suite/`
- **riscv-config/**:**å¯èƒ½**åœ¨å®‰è£…PythonåŒ…è¿‡ç¨‹ä¸­å·²ç»å®‰è£…ï¼Œä½†ä¸æ˜¯æœ€æ–°çš„ã€‚å¦‚æœå·²ç»å®‰è£…ï¼Œå¿…é¡»å¸è½½`pip uninstall riscv-config`ç„¶åä»Githubä»“åº“å®‰è£…æœ€æ–°ä»£ç `pip install git+https://github.com/riscv/riscv-config.git`

### è¿è¡Œæµ‹è¯•

```shell
cd riscv-arch-test/riscof-plugins/rv32 #If you want to run the rv64 test, change this to rv64
riscof run --config config.ini --suite ../../riscv-test-suite/ --env ../../riscv-test-suite/env
```

è¿è¡Œå®Œæ¯•ä¼šç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæ‰“å¼€æŸ¥çœ‹è¯¦ç»†ã€‚

çœ‹å®Œå®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬åªæ˜¯é…ç½®å¥½äº†æµ‹è¯•ç¯å¢ƒï¼Œè¿è¡Œäº†å®˜æ–¹æ¨¡æ‹Ÿå™¨ï¼Œå®Œå…¨æ²¡æœ‰æ•™æ€ä¹ˆæµ‹è¯•è‡ªå·±çš„å¤„ç†å™¨ã€‚ğŸ˜«å…³äºç§»æ¤æµ‹è¯•çš„å†…å®¹å®˜æ–¹æ–‡æ¡£å†™å¾—æ¯”è¾ƒé›¶æ•£ï¼Œç”±å‡ ä¸ªä¸åŒçš„é¡¹ç›®æ‹¼æ¥è€Œæˆï¼Œå…¶ä¸­è¿˜å¤¹æ‚ç€ä¸€äº›**è¿‡æœŸ**å†…å®¹ï¼Œè®©äººé˜²ä¸èƒœé˜²ã€‚ğŸ¤—

## æµ‹è¯•æµç¨‹

[å®˜æ–¹å‚è€ƒæ–‡æ¡£](https://github.com/riscv-non-isa/riscv-arch-test/blob/dev/doc/README.adoc#The%20architectural%20tests)

åœ¨æµ‹è¯•ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å¼„æ¸…ä¸‹é¢çš„æ¦‚å¿µï¼š

- **Test Suites(æµ‹è¯•å¥—ä»¶)**: æ ¹æ®ä¸åŒISAå­é›†å¯¹æµ‹è¯•è¿›è¡Œåˆ†ç»„ï¼Œä¸»è¦åŒ…å«æµ‹è¯•æ‰€éœ€çš„**æ±‡ç¼–ç¨‹åºä»£ç **
- **The test signature(æµ‹è¯•ç­¾å)**: æ¯ä¸€é¡¹æµ‹è¯•ç»“æŸæ—¶ä¼šç”Ÿæˆä¸€ä»½ç­¾åï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å¤„ç†å™¨ä¼šå‘æŒ‡å®šçš„å†…å­˜åŒºåŸŸå†™å…¥æ•°æ®ï¼Œç­¾åå°±æ˜¯è¿™äº›æ•°æ®çš„å€¼
- **The reference signature(å‚è€ƒç­¾å)**: ç”±å‚è€ƒæ¨¡å‹ï¼ˆSpike å’Œ SAILï¼‰è¿è¡Œæµ‹è¯•ç”Ÿæˆï¼Œå°†æµ‹è¯•ç­¾åä¸ä¹‹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå®Œå…¨ç›¸åŒåˆ™è¡¨æ˜æµ‹è¯•é€šè¿‡
- **The test target(æµ‹è¯•ç›®æ ‡)**: è¿›è¡Œæµ‹è¯•çš„ç›®æ ‡ï¼Œå¯ä»¥æ˜¯:
- - RISC-V Instruction Set Simulatorï¼ˆæŒ‡ä»¤é›†ä»¿çœŸå™¨ï¼‰
- - RISC-V emulatorï¼ˆä»¿çœŸå™¨ï¼‰
- - RISC-V RTL model running on an HDL simulatorï¼ˆHDLä»¿çœŸå™¨ä¸Šçš„RTLæ¨¡å‹ï¼‰
- - RISC-V FPGA implementation or a physical chipï¼ˆå®ç°RISC-Vçš„FPGAæˆ–ç‰©ç†èŠ¯ç‰‡ï¼‰
- **Device Under Test(DUT)(è¢«æµ‹è®¾å¤‡)**: å®é™…è¿›è¡Œæµ‹è¯•çš„è®¾å¤‡ï¼Œè¢«ç”¨ä½œä¸å‚è€ƒæ¨¡å‹æ¯”è¾ƒ

å› æ­¤ï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±æ˜¯æ„å»ºæˆ‘ä»¬çš„DUTï¼Œç„¶åè®©DUTè¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆæµ‹è¯•ç­¾åæ–‡ä»¶ã€‚

### å¦‚ä½•åˆ›å»ºæ–°çš„æµ‹è¯•ç›®æ ‡å¹¶æ¥å…¥æˆ‘ä»¬çš„DUTï¼Ÿ

ä¸€è‡´æ€§æµ‹è¯•ä½¿ç”¨åŸºäºPythonçš„[RISCOF](https://riscof.readthedocs.io/en/latest/)æ¥å®Œæˆæµ‹è¯•æµç¨‹

RISCOFé€šè¿‡DUT pluginï¼ˆDUTæ’ä»¶ï¼‰æ¥æ·»åŠ æ–°çš„DUTï¼Œå› æ­¤æˆ‘ä»¬è¦å…ˆç»™è‡ªå·±çš„DUT[åˆ›å»ºä¸€ä¸ªDUTæ’ä»¶](https://riscof.readthedocs.io/en/latest/plugins.html#tips)

å¯ä»¥å¿«é€Ÿåœ¨å½“å‰ç›®å½•ï¼ˆæœ€å¥½æ˜¯ç©ºæ–‡ä»¶å¤¹ï¼‰åˆ›å»ºä¸€ä¸ªæ¨¡æ¿`riscof setup --refname=sail_cSim --dutname=[dutname]`è‡ªè¡Œç¼–è¾‘ä½ çš„DUTåç§°ï¼Œç„¶åå½“å‰ç›®å½•å°±ä¼šå¤šå‡ºä¸‰ä¸ªä¸œè¥¿ï¼šé…ç½®æ–‡ä»¶`config.ini`,å‚è€ƒæ¨¡å‹æ–‡ä»¶å¤¹`sail_cSim`,DUTæ–‡ä»¶å¤¹`[dutname]`ï¼Œä¸¤ä¸ªæ–‡ä»¶å¤¹å†…åˆ†åˆ«æ˜¯ä¸¤ä¸ªæ’ä»¶ã€‚

#### é€‚é…DUTé…ç½®

åˆ›å»ºçš„æ¨¡æ¿ä¸­æœ‰è®¸å¤šè¿‡æœŸçš„å†…å®¹ï¼ˆæ„æ–™ä¹‹å†…ï¼‰ï¼Œç‰¹åˆ«æ˜¯å‚è€ƒæ¨¡å‹ï¼Œå»ºè®®ç›´æ¥æŠŠä¸€è‡´æ€§æµ‹è¯•çš„å†…ç½®æ’ä»¶ä¸­`riscv-arch-test/riscof-plugins/rv32/sail_cSim`å‚è€ƒæ¨¡å‹éƒ¨åˆ†å¤åˆ¶è¿‡æ¥ç”¨

ç„¶åç¼–è¾‘`[dutname]`é‡Œçš„`\*_isa.yaml`ï¼Œå’Œ`\*_platform.yaml`æ–‡ä»¶é…ç½®ï¼Œä½¿å…¶ç¬¦åˆä½ çš„DUTçš„ç‰¹æ€§ï¼Œä¾‹å¦‚è®¾ç½®åœ°å€ä½å®½ï¼Œå®ç°çš„æŒ‡ä»¤é›†ä¹‹ç±»çš„ã€‚å…·ä½“è¯·[æŸ¥çœ‹YAMLé…ç½®è§„åˆ™](https://riscv-config.readthedocs.io/en/stable/)

ç¼–è¾‘å®Œæˆåä½¿ç”¨`riscof validateyaml --config config.ini`éªŒè¯æ˜¯å¦æœ‰æ•ˆï¼Œè¿™ä¸ªå‘½ä»¤æœ‰æ—¶å€™ä¼šè«åå…¶å¦™æŠ¥é”™ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚

#### ä¿®æ”¹Pythonæ’ä»¶æ–‡ä»¶

ç„¶åéœ€è¦ç¼–è¾‘DUTæ’ä»¶çš„Pythonæ’ä»¶æ–‡ä»¶ï¼Œæµ‹è¯•æµç¨‹ä¼šè°ƒç”¨æ’ä»¶æ–‡ä»¶æ¥æ‰§è¡Œæµ‹è¯•ï¼Œæ¨¡æ¿ä»£ç ä¸­å·²ç»å¸®æˆ‘ä»¬æŠŠå¤§éƒ¨åˆ†äº‹æƒ…åšå¥½äº†ã€‚

æ’ä»¶æ€»å…±åšäº†3ä»¶äº‹ï¼š

1. è¯»å–ä¸¤ä¸ªYAMLé…ç½®æ–‡ä»¶ä¸æµ‹è¯•å¥—ä»¶
2. ç¼–è¯‘æ„å»ºæ±‡ç¼–æµ‹è¯•ä»£ç ï¼Œç”ŸæˆELF
3. æŠŠELFè·¯å¾„ç­‰å‚æ•°ä¼ é€’ç»™DUT

å…¶ä¸­DUTå¿…é¡»æ˜¯ä¸ªå¯æ‰§è¡Œç¨‹åºï¼ŒPythonæ’ä»¶ä¿®æ”¹è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥å‚è€ƒæœ¬é¡¹ç›®çš„ä»£ç ã€‚

### HDLä»¿çœŸå™¨æ„å»ºDUT

æˆ‘ä»¬ç¼–å†™çš„SystemVerilogä»£ç æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªRTLæ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨HDLä»¿çœŸå™¨ä»¿çœŸè¿è¡Œä»£ç å……å½“DUTã€‚

ä¸‹é¢ä¼šä½¿ç”¨[Verilator](https://verilator.org/guide/latest/)ä½œä¸ºä»¿çœŸå™¨ï¼Œæ²¡æœ‰å®‰è£…çš„è¯·å…ˆå®‰è£…ã€‚

Verilatorå¯ä»¥å°†RTLæ¨¡å‹ç¼–è¯‘ä¸ºä¸€ä¸ªC++ç±»ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±ç¼–å†™ä¸€ä¸ªä¸»ç¨‹åº(main()å‡½æ•°)ï¼Œå³â€œåŒ…è£…å™¨â€æ¥æ§åˆ¶æ¨¡å‹çš„è¾“å…¥è¾“å‡ºç«¯å£ï¼Œåœ¨C++ç¨‹åºä¸­å®Œæˆä»¿çœŸï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„ä»¿çœŸå™¨ï¼ŒVerilatorçš„ä»¿çœŸé€Ÿåº¦å¾ˆå¿«ã€‚

å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼ŒVerilatorå¯¹SVä»£ç çš„ç»¼åˆéƒ¨åˆ†å¾ˆå‹å¥½ï¼Œè€Œä¸å¯ç»¼åˆéƒ¨åˆ†åˆ™æœ‰é™åˆ¶ï¼Œä»£ç å®¡æŸ¥ä¹Ÿæ›´åŠ ä¸¥æ ¼ã€‚

ä½ å¯ä»¥ä½¿ç”¨è¿™æ¡æŒ‡ä»¤æŠŠSVä»£ç ç¼–è¯‘ä¸ºC++ï¼Œåˆ›å»ºmakefileæ–‡ä»¶ï¼Œç„¶åç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…·ä½“è¯·æŸ¥é˜…[æ–‡æ¡£](https://verilator.org/guide/latest/)

```sh
verilator --top [top_module] -cc [xx0.sv] [xx1.sv] --exe --build [xx0.cpp] [xx1.cpp]
```

#### ä»¿çœŸç¨‹åº

ä»¿çœŸç¨‹åºä¸»è¦å®Œæˆä»¥ä¸‹å·¥ä½œï¼š

1. æŠŠç¼–è¯‘å¥½çš„æµ‹è¯•æŒ‡ä»¤åŠ è½½åˆ°å†…å­˜(RTLæ¨¡å‹çš„å†…å­˜)ä¸­ï¼ŒELFè·¯å¾„é€šè¿‡æ’ä»¶ä¼ å…¥
2. å¤ä½ï¼Œæ§åˆ¶æ—¶é’Ÿä¿¡å·ç­‰ï¼Œå®Œæˆä»¿çœŸ
3. æµ‹è¯•æŒ‡ä»¤ä¼šä½¿ç”¨ä¸€ç§è¢«ç§°ä¸ºHTIFçš„æœºåˆ¶ä¸å¤–æ¥äº¤äº’ï¼Œä»è€Œé€šçŸ¥æµ‹è¯•ç»“æŸï¼Œå®é™…ä¸Šå°±æ˜¯å¾€`tohost`åœ°å€å†™å…¥1ï¼Œéœ€è¦ç›‘æ§è¿™ä¸ªå†™å…¥ä»è€Œç»“æŸä»¿çœŸ
4. åœ¨ä»¿çœŸç»“æŸæˆ–è€…è¶…æ—¶åï¼Œè¿›è¡Œå–è¯ï¼Œå¹¶ç”Ÿæˆæµ‹è¯•ç­¾åæ–‡ä»¶ï¼Œå®é™…ä¸Šå°±æ˜¯è¯»å–`begin_signature`åœ°å€åˆ°`end_signature`åœ°å€çš„æ•°æ®ï¼Œä»¥**å°å†™16è¿›åˆ¶æ–‡æœ¬**å½¢å¼**å°ç«¯åº**ä¿å­˜æ¯ä¸ªå­—çš„æ•°æ®ï¼Œæ¯ä¸ªå­—å ç”¨ä¸€è¡Œï¼Œç­¾åæ–‡ä»¶è·¯å¾„é€šè¿‡æ’ä»¶ä¼ å…¥

`tohost`,`begin_signature`,`end_signature`è¿™ä¸‰ä¸ªåœ°å€ï¼Œåœ¨**æ±‡ç¼–ç¬¦å·è¡¨**ä¸­å¯ä»¥æŸ¥è¯¢åˆ°ï¼Œä½ å¯ä»¥åœ¨ä»¿çœŸç¨‹åºä¸­è‡ªè¡Œè§£æç¬¦å·è¡¨ï¼Œä¹Ÿå¯ä»¥åœ¨æ’ä»¶ä¸­ç¼–è¯‘æ±‡ç¼–ä»£ç æ—¶æå–ç¬¦å·è¡¨ç„¶åä¼ å…¥ä»¿çœŸç¨‹åºã€‚

å¯¹äºå°å‹çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›æœ‰äº›ä»£ç æ®µä»0x00åœ°å€å¼€å§‹ï¼ŒèŠ‚çº¦ä»¿çœŸå†…å­˜ã€‚åœ¨æ’ä»¶æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªé“¾æ¥å™¨è„šæœ¬`[dutname]/env/link.ld`ï¼Œä½ å¯ä»¥åœ¨æ­¤ä¿®æ”¹ä»£ç æ®µçš„èµ·å§‹åœ°å€`.text.init`ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæµ‹è¯•æŒ‡ä»¤ä¸­å†™å…¥æ“ä½œä¾èµ–äº**ç¬¦å·è¡¨**ï¼Œå¦‚æœä½ æ²¡æœ‰ä¿®æ”¹é“¾æ¥å™¨è„šæœ¬ä¾ç„¶ä»å†…å­˜çš„0x00åœ°å€åŠ è½½ä»£ç æ®µï¼ˆä»£ç æ®µå‰é€šå¸¸æ˜¯å…¨0çš„æ— æ•ˆæ•°æ®ï¼‰ï¼Œå†™å…¥åœ°å€å°†ä¼šä¸**ç¬¦å·è¡¨**ä¸­åœ°å€ä¸ç¬¦ï¼Œ`tohost`,`begin_signature`,`end_signature`ä¸‰ä¸ªåœ°å€éƒ½éœ€è¦å‡å»ä»£ç æ®µèµ·å§‹åœ°å€ï¼Œä»£ç æ®µèµ·å§‹åœ°å€é€šå¸¸å°±æ˜¯`rvtest_entry_point`ï¼Œåœ¨**ç¬¦å·è¡¨**ä¸­å¯ä»¥æŸ¥è¯¢åˆ°ã€‚

å…·ä½“çš„C++ç¨‹åºå¯ä»¥å‚è€ƒæœ¬é¡¹ç›®ä»£ç ã€‚

## è¿è¡Œæµ‹è¯•

è¿™é‡Œä¼šä»¥æœ¬é¡¹ç›®çš„ä»£ç ä¸ºä¾‹ï¼Œè¿è¡Œæµ‹è¯•

`cd riscof-plugin/verilator_cpp`

æœç´¢æ‰€æœ‰svä»£ç ï¼Œå¿½ç•¥å®šä¹‰æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶åˆ—è¡¨æ”¾åˆ°rtl.filesä¸­
`find [search_path] -type d -name "Defines" -prune -o -type f -name "*.sv" -print > rtl.files`

ç¼–è¯‘SVå¹¶æ„å»ºä»¿çœŸç¨‹åº
`verilator --top RISC_V_Core -cc -f rtl.files --exe --build --trace-fst sim_main.cpp sim_mem.cpp utils.cpp htif.cpp -Isrc`

`cd ..`

è¿è¡Œæµ‹è¯•ï¼Œè¯·è‡ªè¡Œæ›¿æ¢riscv-arch-testä»“åº“è·¯å¾„
`riscof run --config config.ini --suite [riscv-arch-test]/riscv-test-suite/ --env [riscv-arch-test]/riscv-test-suite/env/`

[å®˜æ–¹æ–‡æ¡£]:(https://github.com/riscv-non-isa/riscv-arch-test/blob/dev/README.md)
